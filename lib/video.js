!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.video=t():e.video=t()}(this,function(){return function(e){function t(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,s){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:s})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=2)}([function(e,t,n){function s(e){o||n(4)}var o=!1,i=n(5)(n(1),n(6),s,"data-v-c8b22efe",null);i.options.__file="E:\\gihub_repository\\vue2-customVideo\\src\\components\\video\\video.vue",i.esModule&&Object.keys(i.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] video.vue: functional components are not supported with templates, they should use render functions."),e.exports=i.exports},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(3);t.default={name:"vue-video",data:function(){var e=this;return{tempWidth:this.width?this.width:"800px",tempHeight:this.height?this.height:"500px",v:null,windowFn:{},ontimeupdateFlag:!0,playBtnClass:"play_icon",duration:"99:99",curTime:"00:00",lastVolume:null,initVolumePercentage:0,volumeFlag:!1,volumeClass:"volume_icon3",fullChangeClass:"fullChangeFull",progressBarWidth:0,bufferBarWidth:0,progressFlag:!1,initProgressPercentage:0,changeFullScreenEvent:null,contextmenuFlagg:!1,contextmenuStyle:{top:0,left:0},contextmenuList:[{function:"播放速度",options:[{value:.5,sel:!1},{value:1,sel:!0},{value:1.25,sel:!1},{value:1.5,sel:!1},{value:2,sel:!1}],optionsFn:function(t){e.contextmenuList[0].options.find(function(e){return e.sel}).sel=!1,e.contextmenuList[0].options.find(function(e){return e.value===t}).sel=!0,e.v.playbackRate=t}},{function:"I'm fox",static:"static"},{function:"关闭",closeFn:function(){e.contextmenuFlagg=!1}}],contextmenuListHight:30,keyDownShowFlag:!1,keyDownShowTimer:null,definitionArr:[{src:this.definition&&this.definition.high,text:"超清",sel:!1},{src:this.src,text:"高清",sel:!0},{src:this.definition&&this.definition.low,text:"流畅",sel:!1}],lastCurrentTime:null,lastVideoState:null,tempVideoSrc:null}},props:["src","width","height","playImg","poster","menu","definition"],methods:{tempVideoFn:function(){this.v.src=this.tempVideoSrc,this.tempVideoSrc=null,this.v.currentTime=this.lastCurrentTime,this.lastVideoState||this.v.play()},changeDefinition:function(e,t){this.definitionArr.find(function(e){return e.sel}).sel=!1,e.sel=!0,this.lastCurrentTime=this.v.currentTime,this.lastVideoState=this.v.paused,this.tempVideoSrc=e.src},keyCondition:function(){this.$el.setAttribute("tabindex",1),this.$el.focus()},keyupFn:function(){var e=this;this.keyDownShowTimer=setTimeout(function(){e.keyDownShowFlag=!1},1e3)},keydownFn:function(e){var t=e||window.event,n=.01*this.v.duration,o=null;switch(32===t.keyCode&&this.playFn(),!0){case 38===t.keyCode:this.v.volume>.9&&(this.v.volume=1),this.v.volume<1&&this.v.volume<=.9&&(this.v.volume+=.1),this.v.volume=Number(this.v.volume.toFixed(4)),this.initVolumePercentage=this.$refs.volumeBgBar.offsetHeight*this.v.volume;break;case 40===t.keyCode:this.v.volume<.1&&(this.v.volume=0),this.v.volume>0&&this.v.volume>=.1&&(this.v.volume-=.1),this.v.volume=Number(this.v.volume.toFixed(4)),this.initVolumePercentage=this.$refs.volumeBgBar.offsetHeight*this.v.volume;break;case 37===t.keyCode:o=this.v.currentTime>n?this.v.currentTime-n:0;break;case 39===t.keyCode:o=this.v.currentTime+n<this.v.duration?this.v.currentTime+n:this.v.duration}return 38!==t.keyCode&&40!==t.keyCode||(clearTimeout(this.keyDownShowTimer),this.keyDownShowFlag=!0),this.volumeClass=s.a.changeVolumeIconClass(this.v.volume),this.lastVolume=this.v.volume,null!==o&&(this.initProgressPercentage=o/this.v.duration*this.bgBarWidth,this.v.currentTime=o,this.curTime=s.a.formatDate(Math.round(this.v.currentTime))),t.preventDefault(),!1},contextmenuBox:function(e){return(e||window.event).preventDefault(),!1},contextmenu:function(e){if(!this.menu)return!1;var t=e||window.event,n=parseInt(s.a.getStyle(this.$refs.contextmenuBox).width),o=this.contextmenuList.length*this.contextmenuListHight;return this.contextmenuFlagg=!0,this.contextmenuStyle.top=t.offsetY+5+"px",this.contextmenuStyle.left=t.offsetX+"px",parseInt(this.tempWidth)-t.offsetX<n&&(this.contextmenuStyle.left=t.offsetX-n+"px"),parseInt(this.tempHeight)-t.offsetY<o&&(this.contextmenuStyle.top=t.offsetY-o-5+"px"),"img"===t.target.tagName.toLowerCase()&&(this.contextmenuStyle.left=parseInt(this.contextmenuStyle.left)+parseInt(this.tempWidth)/2-t.target.offsetWidth/2+"px",this.contextmenuStyle.top=parseInt(this.contextmenuStyle.top)+parseInt(this.tempHeight)/2-t.target.offsetHeight/2+"px"),t.preventDefault(),!1},playFn:function(){this.v.paused?this.v.play():this.v.pause(),this.playBtnClass=this.v.paused?"play_icon":"pause_icon"},switchVolume:function(e){var t=e||window.event;(t.target.classList.contains("clickIcon")||t.target.classList.contains("volumeBtn"))&&(0===this.v.volume?(this.v.volume=this.lastVolume,this.initVolumePercentage=this.$refs.volumeBgBar.offsetHeight*this.v.volume):(this.v.volume=0,this.initVolumePercentage=0),this.volumeClass=s.a.changeVolumeIconClass(this.v.volume))}},computed:{playImgFlag:function(){return!!this.playImg&&"play_icon"===this.playBtnClass}},watch:{},mounted:function(){var e=this;this.v=this.$refs.video,this.v.oncanplay=function(){e.duration=s.a.formatDate(Math.round(e.v.duration)),e.lastVolume=e.v.volume},this.v.onprogress=function(){try{e.bufferBarWidth=e.v.buffered.end(0)/e.v.duration*e.progressBarWidth*.96}catch(e){}},this.initVolumePercentage=this.v.volume*this.$refs.volumeBgBar.offsetHeight;var t=void 0,n=void 0,o=void 0,i=[0,this.$refs.volumeBgBar.offsetHeight],r=i[0],a=i[1],l=function(n){e.volumeFlag=!e.volumeFlag;var s=n||window.event;t=s.pageY,o=e.$refs.volumeBall.offsetTop,e.$refs.volumeBar.classList.add("volumeBarShow")};this.windowFn.VdragMouseMove=function(i){if(!e.volumeFlag)return!1;var l=i||window.event;n=l.pageY,e.initVolumePercentage=e.$refs.volumeBgBar.offsetHeight-(o+parseInt(n-t)+e.$refs.volumeBall.offsetHeight),e.initVolumePercentage=e.initVolumePercentage<=r?r:e.initVolumePercentage,e.initVolumePercentage=e.initVolumePercentage>=a?a:e.initVolumePercentage,e.v.volume=e.lastVolume=e.initVolumePercentage/e.$refs.volumeBgBar.offsetHeight,e.volumeClass=s.a.changeVolumeIconClass(e.v.volume)},this.windowFn.VdragMouseUp=function(){if(!e.volumeFlag)return!1;e.volumeFlag=!e.volumeFlag,e.$refs.volumeBar.classList.remove("volumeBarShow")};var u=function(t){var n=t||window.event;n.target===e.$refs.volumeBgBar&&(e.initVolumePercentage=e.$refs.volumeBgBar.offsetHeight-n.offsetY),n.target.classList.contains("colorBar")&&(e.initVolumePercentage=e.$refs.volumeBgBar.offsetHeight-(n.offsetY+e.$refs.volumeBall.offsetTop+e.$refs.volumeBall.offsetHeight)),e.v.volume=e.lastVolume=e.initVolumePercentage/e.$refs.volumeBgBar.offsetHeight,e.volumeClass=s.a.changeVolumeIconClass(e.v.volume)};this.$refs.volumeBall.addEventListener("mousedown",l,!1),window.addEventListener("mousemove",this.windowFn.VdragMouseMove,!1),window.addEventListener("mouseup",this.windowFn.VdragMouseUp,!1),this.$refs.volumeBgBar.addEventListener("click",u,!1),this.keyDownShowStyle={width:.15*parseInt(this.tempWidth)+"px"};var c=0;[].slice.call(this.$refs.controls.children).forEach(function(e,t){!e.classList.contains("progressBar")&&(c+=Math.ceil(s.a.getStyle(e).width.match(/[^(px)*]/g).join(""))),!e.classList.contains("progressBar")&&(c+=Math.round(s.a.getStyle(e).paddingLeft.match(/[^(px)*]/g).join(""))),!e.classList.contains("progressBar")&&(c+=Math.round(s.a.getStyle(e).paddingRight.match(/[^(px)*]/g).join("")))}),c=this.$refs.controls.offsetWidth-c,this.progressBarWidth=c;var d=void 0,v=void 0,m=void 0,f=function(t){var n=t||window.event;e.progressFlag=!e.progressFlag,e.ontimeupdateFlag&&(e.ontimeupdateFlag=!1),d=n.pageX,m=e.$refs.progressBall.offsetLeft},h=.96*c;this.bgBarWidth=h;var g=0,p=h;this.windowFn.PdragMouseMove=function(t){if(!e.progressFlag)return!1;var n=t||window.event;v=n.pageX,e.initProgressPercentage=v-d+m,e.initProgressPercentage=e.initProgressPercentage<=g?g:e.initProgressPercentage,e.initProgressPercentage=e.initProgressPercentage>=p?p:e.initProgressPercentage,e.curTime=s.a.formatDate(Math.round(e.initProgressPercentage/h*e.v.duration))},this.windowFn.PdragMouseUp=function(t){if(!e.progressFlag)return!1;e.ontimeupdateFlag=!0,e.v.currentTime=e.initProgressPercentage/h*e.v.duration,e.progressFlag=!e.progressFlag};var w=function(t){var n=t||window.event;n.target.classList.contains("ball")||(e.initProgressPercentage=n.offsetX),e.v.currentTime=e.initProgressPercentage/h*e.v.duration};this.$refs.progressBall.addEventListener("mousedown",f,!1),window.addEventListener("mousemove",this.windowFn.PdragMouseMove,!1),window.addEventListener("mouseup",this.windowFn.PdragMouseUp,!1),this.$refs.progressBgBar.addEventListener("click",w,!1);var y=!1,x=null,C=["onfullscreenchange","onmozfullscreenchange","onwebkitfullscreenchange","onmsfullscreenchange"],F=this.$refs.wrap,B=F.requestFullscreen||F.oRequestFullscreen||F.msRequestFullscreen||F.mozRequestFullScreen||F.webkitRequestFullscreen,_=document.exitFullscreen||document.msExitFullscreen||document.mozCancelFullScreen||document.oCancelFullScreen||document.webkitExitFullscreen,P=function(){e.$refs.controls.classList.contains("fadeout")&&e.$refs.controls.classList.remove("fadeout"),null!==x&&clearTimeout(x),x=setTimeout(function(){e.$refs.controls.classList.add("fadeout")},5e3)},S=function(){e.$refs.video.removeEventListener("mousemove",P),e.$refs.controls.classList.contains("fadeout")&&e.$refs.controls.classList.remove("fadeout"),null!==x&&clearTimeout(x)},L=function(){e.$refs.video.addEventListener("mousemove",P)};C.forEach(function(t,n){if(void 0!==document[t])return e.changeFullScreenEvent=t,t.match(/ms/g)&&(e.changeFullScreenEvent="onMSFullscreenChange"),!1}),this.windowFn.changeFullScreenFn=function(t){y&&(e.fullChangeClass="fullChangeFull"),y||(e.fullChangeClass="fullChangeMini"),y?(e.$refs.wrap.style.width=e.tempWidth,e.$refs.wrap.style.height=e.tempHeight,e.$refs.controls.classList.remove("fullScreen"),e.$refs.video.removeEventListener("mousemove",P),e.$refs.controls.removeEventListener("mouseover",S),e.$refs.controls.removeEventListener("mouseout",L),e.$refs.controls.classList.contains("fadeout")&&e.$refs.controls.classList.remove("fadeout"),null!==x&&clearTimeout(x),e.keyDownShowStyle={width:.15*parseInt(e.tempWidth)+"px"}):(e.$refs.wrap.style.width=window.screen.width+"px",e.$refs.wrap.style.height=window.screen.height+"px",e.$refs.controls.classList.add("fullScreen"),e.$refs.video.addEventListener("mousemove",P),e.$refs.controls.addEventListener("mouseover",S),e.$refs.controls.addEventListener("mouseout",L),P(),e.keyDownShowStyle={width:.07*window.screen.width+"px"}),c=0,[].slice.call(e.$refs.controls.children).forEach(function(e,t){!e.classList.contains("progressBar")&&(c+=Math.ceil(s.a.getStyle(e).width.match(/[^(px)*]/g).join(""))),!e.classList.contains("progressBar")&&(c+=Math.round(s.a.getStyle(e).paddingLeft.match(/[^(px)*]/g).join(""))),!e.classList.contains("progressBar")&&(c+=Math.round(s.a.getStyle(e).paddingRight.match(/[^(px)*]/g).join("")))}),c=e.$refs.controls.offsetWidth-c,e.progressBarWidth=c,h=.96*c,e.bgBarWidth=h,g=0,p=h,e.initProgressPercentage=e.v.currentTime/e.v.duration*h,e.bufferBarWidth=e.v.buffered.end(0)/e.v.duration*e.progressBarWidth*.96,y=!y},document.addEventListener(this.changeFullScreenEvent.slice(2),this.windowFn.changeFullScreenFn);var $=function(e){y?_.call(document):B.call(F)};this.$refs.fullChange.addEventListener("click",$),this.v.ontimeupdate=function(){if(!e.ontimeupdateFlag)return!1;e.curTime=s.a.formatDate(Math.round(e.v.currentTime)),e.initProgressPercentage=e.v.currentTime/e.v.duration*h},this.v.onended=function(){e.v.paused&&(e.playBtnClass="play_icon"),e.v.currentTime=0},this.windowFn.hideContextmenu=function(t){(t||window.event).target.classList.contains("function")||(e.contextmenuFlagg=!1)},window.addEventListener("click",this.windowFn.hideContextmenu,!1),this.v.onerror=function(){console.log("视频源加载错误")}},beforeDestroy:function(){document.removeEventListener(this.changeFullScreenEvent.slice(2),this.windowFn.changeFullScreenFn),window.removeEventListener("mousemove",this.windowFn.VdragMouseMove,!1),window.removeEventListener("mouseup",this.windowFn.VdragMouseUp,!1),window.removeEventListener("mousemove",this.windowFn.PdragMouseMove,!1),window.removeEventListener("mouseup",this.windowFn.PdragMouseUp,!1),window.removeEventListener("click",this.windowFn.hideContextmenu,!1)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),o=n.n(s),i=function(e,t){e.component(o.a.name,o.a)};"undefined"!=typeof window&&window.Vue&&i(window.Vue),t.default={install:i}},function(e,t,n){"use strict";var s=(Math.ceil,Math.floor);t.a={addZero:function(e){return e>9?e:"0"+e},formatDate:function(e){var t=this.addZero(s(e/60));return t+":"+this.addZero(e-60*t)},changeVolumeIconClass:function(e){var t=void 0;return e>.8&&e<=1&&(t="volume_icon3"),e>.45&&e<=.8&&(t="volume_icon2"),e>0&&e<=.45&&(t="volume_icon1"),0===e&&(t="mute_icon"),t},getStyle:function(e){return window.getComputedStyle?window.getComputedStyle(e,null):e.currentStyle}}},function(e,t){},function(e,t){e.exports=function(e,t,n,s,o){var i,r=e=e||{},a=typeof e.default;"object"!==a&&"function"!==a||(i=e,r=e.default);var l="function"==typeof r?r.options:r;t&&(l.render=t.render,l.staticRenderFns=t.staticRenderFns),s&&(l._scopeId=s);var u;if(o?(u=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},l._ssrRegister=u):n&&(u=n),u){var c=l.functional,d=c?l.render:l.beforeCreate;c?l.render=function(e,t){return u.call(t),d(e,t)}:l.beforeCreate=d?[].concat(d,u):[u]}return{esModule:i,exports:r,options:l}}},function(e,t,n){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"wrap",staticClass:"wrap",style:{width:e.tempWidth,height:e.tempHeight},on:{keydown:e.keydownFn,keyup:e.keyupFn,click:e.keyCondition}},[e.tempVideoSrc?n("video",{staticClass:"tempVideo",attrs:{src:e.tempVideoSrc,preload:"auto"},on:{canplay:e.tempVideoFn}}):e._e(),e._v(" "),n("video",{ref:"video",attrs:{poster:e.poster,src:e.src,preload:"auto"},on:{click:e.playFn,contextmenu:e.contextmenu}},[n("h1",[e._v("您的浏览器不支持H5的video标签，请更换较为先进的浏览器")])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.contextmenuFlagg,expression:"contextmenuFlagg"}],ref:"contextmenuBox",staticClass:"contextmenuBox",style:e.contextmenuStyle,on:{contextmenu:e.contextmenuBox}},e._l(e.contextmenuList,function(t){return n("div",{staticClass:"list",class:[t.static],style:{height:e.contextmenuListHight+"px"}},[t.closeFn?n("div",{staticClass:"function",domProps:{textContent:e._s(t.function)},on:{click:t.closeFn}}):n("div",{staticClass:"function",domProps:{textContent:e._s(t.function)}}),e._v(" "),t.options?n("div",{staticClass:"options"},e._l(t.options,function(s){return n("div",{staticClass:"option",class:{selected:s.sel},domProps:{textContent:e._s(s.value)},on:{click:function(e){t.optionsFn(s.value)}}})})):e._e()])})),e._v(" "),e.playImgFlag?n("div",{staticClass:"videoState",on:{contextmenu:e.contextmenu,click:e.playFn}},[n("img",{attrs:{src:e.playImg,alt:""}})]):e._e(),e._v(" "),n("transition",{attrs:{name:"fade"}},[e.keyDownShowFlag?n("div",{staticClass:"keyDownShow",style:e.keyDownShowStyle},[n("div",{staticClass:"volumeBox"},[n("div",{staticClass:"volumeBtn"},[n("div",{class:[e.volumeClass]})])]),e._v(" "),e.v?n("div",{staticClass:"valumeNum"},[e._v(e._s(0===parseInt(100*e.v.volume)?"静音":parseInt(100*e.v.volume)))]):n("div",{staticClass:"valumeNum"},[e._v("100")])]):e._e()]),e._v(" "),n("div",{ref:"controls",staticClass:"controls"},[n("div",{staticClass:"playBtn",on:{click:e.playFn}},[n("div",{class:[e.playBtnClass]})]),e._v(" "),n("div",{staticClass:"progressBar",style:{width:e.progressBarWidth+"px"}},[n("div",{ref:"progressBgBar",staticClass:"bgBar"},[n("div",{staticClass:"colorBar",style:{width:e.initProgressPercentage+"px"}}),e._v(" "),n("div",{staticClass:"bufferBar",style:{width:e.bufferBarWidth+"px"}}),e._v(" "),n("div",{ref:"progressBall",staticClass:"ball",style:{left:e.initProgressPercentage+"px"}})])]),e._v(" "),n("div",{ref:"fullChange",staticClass:"fullChange"},[n("div",{class:[e.fullChangeClass]})]),e._v(" "),e.definition?n("div",{staticClass:"definition"},[n("div",{staticClass:"curDefinition",domProps:{textContent:e._s(e.definitionArr.find(function(e){return e.sel}).text)}}),e._v(" "),n("div",{staticClass:"otherDefinition"},e._l(e.definitionArr,function(t,s){return n("div",{class:{select:t.sel},domProps:{textContent:e._s(t.text)},on:{click:function(n){t.sel||e.changeDefinition(t,s)}}})}))]):e._e(),e._v(" "),n("div",{staticClass:"volume",on:{click:e.switchVolume}},[n("div",{ref:"volumeBar",staticClass:"volumeBar"},[n("div",{ref:"volumeBgBar",staticClass:"bgBar"},[n("div",{staticClass:"colorBar",style:{height:e.initVolumePercentage+"px"}}),e._v(" "),n("div",{ref:"volumeBall",staticClass:"ball",style:{bottom:e.initVolumePercentage+"px"}})])]),e._v(" "),n("div",{staticClass:"volumeBtn"},[n("div",{class:[e.volumeClass]})])]),e._v(" "),n("div",{staticClass:"time"},[n("div",{staticClass:"curTime",domProps:{textContent:e._s(e.curTime)}}),e._v(" "),n("div",[e._v("/")]),e._v(" "),n("div",{staticClass:"sumTime",domProps:{textContent:e._s(e.duration)}})])])],1)},staticRenderFns:[]},e.exports.render._withStripped=!0}])});